<!DOCTYPE html>
<html lang="ko">

<head>
  <meta charset="UTF-8">
  <title>QA í†µí•© ìœ í‹¸ë¦¬í‹°</title>

  <!-- ğŸ”¥ ìˆ˜íŒŒë² ì´ìŠ¤ CDN ì¶”ê°€ -->
  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>

  <!-- External CSS -->
  <link rel="stylesheet" href="assets/css/common.css">
  <link rel="stylesheet" href="assets/css/csv.css">
  <link rel="stylesheet" href="assets/css/groovy.css">
  <link rel="stylesheet" href="assets/css/report.css">
  <link rel="stylesheet" href="assets/css/mapping.css">
  <link rel="stylesheet" href="assets/css/tcmerger.css">
  <link rel="stylesheet" href="assets/css/smart.css">
  <link rel="stylesheet" href="assets/css/objectspy.css">

  <!-- External Libraries -->
  <link rel="stylesheet" href="https://cdn.datatables.net/1.13.4/css/jquery.dataTables.min.css">

  <!-- External Scripts -->
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <script src="https://code.jquery.com/jquery-3.7.0.min.js"></script>
  <script src="https://cdn.datatables.net/1.13.4/js/jquery.dataTables.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.4.1/papaparse.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.10.0/jszip.min.js"></script>
  <script src="assets/js/katalon-object-generator.js"></script>
  <script src="assets/js/object-spy-controller.js"></script>
  <style>
    button.tab-button:disabled {
      opacity: 0.6;
      cursor: not-allowed;
      background-color: #e9ecef;
      color: #6c757d;
    }
  </style>
</head>

<body>
  <header>
    <button class="tab-button" data-tab="csv" disabled>ğŸ“Š CSV íŒŒì‹±</button>
    <button class="tab-button active" data-tab="groovy">âš™ï¸ Groovy ë³€í™˜</button>
    <button class="tab-button" data-tab="report">ğŸ“ˆ ê²°ê³¼ ë¦¬í¬íŠ¸</button>
    <button class="tab-button" data-tab="mapping" disabled>ğŸ”„ í…ŒìŠ¤íŠ¸ì¼€ì´ìŠ¤ ë§¤í•‘</button>
    <button class="tab-button" data-tab="tcmerger" disabled>ğŸ“¦ TC ë³‘í•©/ë¶„ë¦¬</button>
    <button class="tab-button" data-tab="smart">ğŸ§  ìŠ¤ë§ˆíŠ¸ ë§¤í•‘</button>
    <button class="tab-button" data-tab="object-spy">ğŸ” Object Spy</button>
  </header>

  <main>
    <!-- CSV íŒŒì‹± íƒ­ -->
    <div id="csv" class="tab-content">
      <div class="container">
        <div class="csv-header">
          <h2>ğŸ”ª WebUI.comment ê¸°ë°˜ ë©”íƒ€ë°ì´í„° íŒŒì„œ</h2>
          <p>CSV íŒŒì¼ì„ ì—…ë¡œë“œí•˜ì—¬ WebUI.comment ë°ì´í„°ë¥¼ ìë™ìœ¼ë¡œ íŒŒì‹±í•˜ê³  ë¶„ì„í•©ë‹ˆë‹¤</p>
        </div>

        <div class="file-upload-section">
          <div class="file-input-wrapper">
            <input type="file" id="csvFile" accept=".csv">
            <label for="csvFile" class="file-input-label">
              ğŸ“ CSV íŒŒì¼ ì„ íƒ
            </label>
          </div>
          <p style="color: #6b7280; margin: 15px 0 0 0;">CSV íŒŒì¼ì„ ì„ íƒí•˜ë©´ ìë™ìœ¼ë¡œ íŒŒì‹±ì´ ì‹œì‘ë©ë‹ˆë‹¤</p>
        </div>

        <div class="action-buttons">
          <button id="downloadBtn" class="action-btn download-btn">â¬‡ï¸ ì—‘ì…€ ë‹¤ìš´ë¡œë“œ</button>
          <button id="exampleDownloadBtn" class="action-btn example-btn">ğŸ“¥ ì˜ˆì‹œíŒŒì¼ ë‹¤ìš´ë¡œë“œ</button>
        </div>

        <div id="error" class="error" style="display: none;"></div>
        <table id="resultTable" class="display" style="display:none;"></table>
      </div>
    </div>

    <!-- Groovy ë³€í™˜ê¸° íƒ­ -->
    <div id="groovy" class="tab-content active">
      <div class="container">
        <div class="groovy-header">
          <h2>ğŸ“„ Excel â” Katalon Test Case ë³€í™˜ê¸°</h2>
          <p>Excel íŒŒì¼ì„ Katalon í…ŒìŠ¤íŠ¸ ì¼€ì´ìŠ¤(.tc) ë° Groovy ìŠ¤í¬ë¦½íŠ¸ë¡œ ë³€í™˜í•©ë‹ˆë‹¤</p>
        </div>

        <div class="conversion-section">
          <div class="file-input-wrapper">
            <input type="file" id="excelFile" accept=".xlsx">
            <label for="excelFile" class="file-input-label">
              ğŸ“Š Excel íŒŒì¼ ì„ íƒ
            </label>
          </div>
          <p style="color: #6b7280; margin: 15px 0 0 0; text-align: center;">Excel í˜•ì‹ì˜ í…ŒìŠ¤íŠ¸ ì¼€ì´ìŠ¤ë¥¼ ì—…ë¡œë“œí•˜ì„¸ìš”</p>

          <div class="zip-buttons">
            <button onclick="generateAllZip('tc')" class="zip-btn">ğŸ“¦ ì „ì²´ .tc ZIP ë‹¤ìš´ë¡œë“œ</button>
            <button onclick="generateAllZip('groovy')" class="zip-btn">ğŸ“¦ ì „ì²´ .groovy ZIP ë‹¤ìš´ë¡œë“œ</button>
          </div>
        </div>

        <div class="preview-section">
          <div id="preview">
            <div style="text-align: center; color: #6b7280; padding: 50px 0;">
              <h3>ğŸ”„ ë³€í™˜ ë¯¸ë¦¬ë³´ê¸°</h3>
              <p>Excel íŒŒì¼ì„ ì„ íƒí•˜ë©´ ë³€í™˜ ê²°ê³¼ê°€ ì—¬ê¸°ì— í‘œì‹œë©ë‹ˆë‹¤</p>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- ê²°ê³¼ ë¦¬í¬íŠ¸ íƒ­ -->
    <div id="report" class="tab-content">
      <div class="container">
        <div class="report-header">
          <h2>ğŸ§¾ HTML ê²°ê³¼ê°’ Report ë·°ì–´</h2>
          <p>HTML í…ŒìŠ¤íŠ¸ ê²°ê³¼ íŒŒì¼ì„ ì—…ë¡œë“œí•˜ì—¬ ì‹œê°ì ìœ¼ë¡œ ë¶„ì„í•©ë‹ˆë‹¤</p>
        </div>

        <div class="file-upload-section" style="margin-bottom: 30px;">
          <div class="file-input-wrapper">
            <input type="file" id="reportFileInput" accept=".html">
            <label for="reportFileInput" class="file-input-label">
              ğŸ“„ HTML ê²°ê³¼ íŒŒì¼ ì„ íƒ
            </label>
          </div>
          <p style="color: #6b7280; margin: 15px 0 0 0;">í…ŒìŠ¤íŠ¸ ê²°ê³¼ HTML íŒŒì¼ì„ ì—…ë¡œë“œí•˜ì„¸ìš”</p>
        </div>

        <div class="report-viewer">
          <iframe id="reportPreview" class="report-preview"></iframe>
          <div id="reportResult" class="report-result">
            <h2>ğŸ“‹ íŒŒì‹±ëœ ë°ì´í„°ê°€ ì´ ì˜ì—­ì— í‘œì‹œë©ë‹ˆë‹¤</h2>
            <p style="text-align: center; color: #9ca3af;">HTML íŒŒì¼ì„ ì—…ë¡œë“œí•˜ë©´ ë¶„ì„ ê²°ê³¼ì™€ ì°¨íŠ¸ê°€ ì—¬ê¸°ì— ë‚˜íƒ€ë‚©ë‹ˆë‹¤</p>
          </div>
        </div>
      </div>
    </div>

    <!-- ğŸ”¥ í…ŒìŠ¤íŠ¸ì¼€ì´ìŠ¤ ë§¤í•‘ íƒ­ (ìˆ˜íŒŒë² ì´ìŠ¤ ì—°ë™) -->
    <div id="mapping" class="tab-content">
      <div class="mapping-container">
        <div class="panel left-panel">
          <div class="panel-header">
            <span>ğŸ“ í…ŒìŠ¤íŠ¸ì¼€ì´ìŠ¤ ì…ë ¥</span>
            <button class="reset-btn" onclick="resetInput()">ğŸ”„ ì´ˆê¸°í™”</button>
          </div>
          <div class="panel-content">
            <div class="input-section">
              <label class="input-label">í…ŒìŠ¤íŠ¸ì¼€ì´ìŠ¤ ì „ì²´ ë‚´ìš©</label>
              <textarea id="testcaseInput" class="input-box" placeholder="í…ŒìŠ¤íŠ¸ì¼€ì´ìŠ¤ ì „ì²´ ë‚´ìš©ì„ ì…ë ¥í•˜ì„¸ìš”...

ì˜ˆì‹œ:
Summary: ë¡œê·¸ì¸ ê¸°ëŠ¥ í…ŒìŠ¤íŠ¸
Precondition: 
0. ë¸Œë¼ìš°ì €ë¥¼ ì—´ê³  ë¡œê·¸ì¸ í˜ì´ì§€ë¡œ ì´ë™
1. ìœ íš¨í•œ ì‚¬ìš©ì ê³„ì •ì´ ì¡´ì¬í•¨
2. ë„¤íŠ¸ì›Œí¬ ì—°ê²°ì´ ì •ìƒì„
Steps:
1. ì•„ì´ë”” ì…ë ¥ í•„ë“œì— í…ŒìŠ¤íŠ¸ ê³„ì • ì…ë ¥
2. ë¹„ë°€ë²ˆí˜¸ ì…ë ¥ í•„ë“œì— ë¹„ë°€ë²ˆí˜¸ ì…ë ¥
3. ë¡œê·¸ì¸ ë²„íŠ¼ í´ë¦­
Expected Result: ë¡œê·¸ì¸ ì„±ê³µ í›„ ë©”ì¸ í˜ì´ì§€ë¡œ ì´ë™"></textarea>
            </div>
            <button class="extract-btn" onclick="extractTestcaseData()">ğŸ“Š ë°ì´í„° ì¶”ì¶œ</button>
          </div>
        </div>
        <div class="panel center-panel">
          <div class="panel-header">
            <span>ğŸ” íŒŒì‹± ê²°ê³¼</span>
            <button class="reset-btn" onclick="resetParsing()">ğŸ”„ ì´ˆê¸°í™”</button>
          </div>
          <div class="panel-content">
            <div class="parsed-section">
              <div class="section-header">ğŸ“‹ Summary</div>
              <div class="section-content" id="summaryResult">
                <span class="placeholder-text">ì¶”ì¶œëœ Summaryê°€ ì—¬ê¸°ì— í‘œì‹œë©ë‹ˆë‹¤</span>
              </div>
            </div>
            <div class="parsed-section">
              <div class="section-header">âš™ï¸ Precondition</div>
              <div class="section-content" id="preconditionResult">
                <span class="placeholder-text">ì¶”ì¶œëœ Preconditionì´ ì—¬ê¸°ì— í‘œì‹œë©ë‹ˆë‹¤</span>
              </div>
            </div>
            <div class="parsed-section steps-section">
              <div class="section-header">ğŸ”¢ Steps</div>
              <div class="section-content" id="stepsResult">
                <span class="placeholder-text">ì¶”ì¶œëœ Stepsê°€ ì—¬ê¸°ì— í‘œì‹œë©ë‹ˆë‹¤</span>
              </div>
            </div>
            <div class="parsed-section">
              <div class="section-header">âœ… Expected Result</div>
              <div class="section-content" id="expectedResult">
                <span class="placeholder-text">ì¶”ì¶œëœ Expected Resultê°€ ì—¬ê¸°ì— í‘œì‹œë©ë‹ˆë‹¤</span>
              </div>
            </div>
            <button class="convert-btn" id="convertBtn" onclick="generateMappingScript()" disabled>âš¡ ìŠ¤í¬ë¦½íŠ¸ ì „í™˜</button>
          </div>
        </div>
        <div class="panel right-panel">
          <div class="panel-header">
            <span>ğŸ› ï¸ ì¹´íƒˆë¡  ë§¤í•‘ ìŠ¤í¬ë¦½íŠ¸</span>
            <button class="reset-btn" onclick="resetScript()">ğŸ”„ ì´ˆê¸°í™”</button>
          </div>
          <div class="panel-content">
            <div class="script-section">
              <div class="script-header">
                <div class="mapping-indicator no-mapping" id="mappingIndicator"></div>
                ğŸ“‹ í†µí•© ë§¤í•‘ ìŠ¤í¬ë¦½íŠ¸
                <button class="copy-btn" onclick="copyScript()">ğŸ“‹ ë³µì‚¬</button>
              </div>
              <div class="script-content" id="scriptResult">
                <span class="placeholder-text">// ìˆ˜íŒŒë² ì´ìŠ¤ ì—°ë™ ì¹´íƒˆë¡  ë§¤í•‘ ìŠ¤í¬ë¦½íŠ¸ê°€ ì—¬ê¸°ì— ìƒì„±ë©ë‹ˆë‹¤
                  //
                  // === Precondition Scripts ===
                  // Precondition ë§¤í•‘ ìŠ¤í¬ë¦½íŠ¸ê°€ ì—¬ê¸°ì— í‘œì‹œë©ë‹ˆë‹¤
                  //
                  // === Summary Scripts ===
                  // Summary ë§¤í•‘ ìŠ¤í¬ë¦½íŠ¸ê°€ ì—¬ê¸°ì— í‘œì‹œë©ë‹ˆë‹¤
                  //
                  // === Steps Scripts ===
                  // Steps ë§¤í•‘ ìŠ¤í¬ë¦½íŠ¸ê°€ ì—¬ê¸°ì— í‘œì‹œë©ë‹ˆë‹¤
                  //
                  // === Expected Result Scripts ===
                  // Expected Result ë§¤í•‘ ìŠ¤í¬ë¦½íŠ¸ê°€ ì—¬ê¸°ì— í‘œì‹œë©ë‹ˆë‹¤</span>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- TC ë³‘í•©/ë¶„ë¦¬ íƒ­ -->
    <div id="tcmerger" class="tab-content">
      <div class="container">
        <div class="tcmerger-header">
          <h2>ğŸ“¦ Test Case Excel/CSV ë³‘í•© / ë¶„ë¦¬ ë„êµ¬</h2>
          <p>CSV/Excel íŒŒì¼ì˜ í…ŒìŠ¤íŠ¸ ì¼€ì´ìŠ¤ ë‹¨ê³„ë¥¼ ë³‘í•©í•˜ê±°ë‚˜ ë¶„ë¦¬í•©ë‹ˆë‹¤</p>
        </div>

        <div style="display: flex; justify-content: center; margin-bottom: 30px; gap: 10px;">
          <button class="tcmerger-tab-btn active" data-tcmerger-tab="merge" onclick="switchTCMergerTab('merge')">ğŸ“¦ ë³‘í•©
            ê¸°ëŠ¥</button>
          <button class="tcmerger-tab-btn" data-tcmerger-tab="split" onclick="switchTCMergerTab('split')">ğŸ” ë¶„ë¦¬
            ê¸°ëŠ¥</button>
        </div>

        <div id="mergeTab" class="tcmerger-tab-content active">
          <div class="tab-description">
            <h3>ğŸ“¦ ë³‘í•© ê¸°ëŠ¥</h3>
            <p><strong>CSV íŒŒì¼</strong>ì˜ ê°œë³„ Step ì»¬ëŸ¼ë“¤ì„ <strong>Steps</strong>ë¡œ ë³‘í•©í•©ë‹ˆë‹¤.</p>
            <p>â€¢ ì…ë ¥: Steps (Step), Step 1, Step 2, Step 3, Step 4, Step 5, Step 6</p>
            <p>â€¢ ì¶œë ¥: Steps (ìë™ ë²ˆí˜¸ ë§¤ê¸°ê¸° í¬í•¨)</p>
          </div>

          <div class="file-upload-section">
            <h4>ğŸ“ CSV íŒŒì¼ ì—…ë¡œë“œ</h4>
            <div class="file-input-wrapper">
              <input type="file" id="mergeFileInput" accept=".csv">
              <label for="mergeFileInput" class="file-input-label">
                ğŸ“ CSV íŒŒì¼ ì„ íƒ
              </label>
            </div>
            <p style="color: #6c757d; margin-top: 10px;">CSV íŒŒì¼ë§Œ ì§€ì›ë©ë‹ˆë‹¤</p>
          </div>

          <div id="mergeFileInfo" class="file-info"></div>
          <div id="mergeCleaningInfo" class="file-info cleaning-info">
            ğŸ§¹ HTML íƒœê·¸ ì •ë¦¬ ì™„ë£Œ! íƒœê·¸ë“¤ì´ ì ì ˆíˆ ë³€í™˜/ì œê±°ë˜ì—ˆìŠµë‹ˆë‹¤.
          </div>

          <div class="action-buttons">
            <button class="action-btn download-btn" onclick="executeMerge()">ğŸ“¦ ë³‘í•© ì‹¤í–‰</button>
            <button class="action-btn example-btn" onclick="downloadMergeResult()">â¬‡ ë³‘í•© ê²°ê³¼ ë‹¤ìš´ë¡œë“œ</button>
          </div>

          <div id="mergeResult">
            <div class="empty-state">
              <div class="icon">ğŸ“‹</div>
              <p>CSV íŒŒì¼ì„ ì—…ë¡œë“œí•˜ê³  ë³‘í•©ì„ ì‹¤í–‰í•´ì£¼ì„¸ìš”</p>
            </div>
          </div>
        </div>

        <div id="splitTab" class="tcmerger-tab-content">
          <div class="tab-description">
            <h3>ğŸ” ë¶„ë¦¬ ê¸°ëŠ¥</h3>
            <p><strong>Excel íŒŒì¼</strong>ì˜ Stepsë¥¼ ê°œë³„ Step ì»¬ëŸ¼ë“¤ë¡œ ë¶„ë¦¬í•©ë‹ˆë‹¤.</p>
            <p>â€¢ ì…ë ¥: Steps</p>
            <p>â€¢ ì¶œë ¥: Steps (Step), Step 1, Step 2, Step 3, Step 4, Step 5, Step 6</p>
          </div>

          <div class="file-upload-section">
            <h4>ğŸ“ Excel íŒŒì¼ ì—…ë¡œë“œ</h4>
            <div class="file-input-wrapper">
              <input type="file" id="splitFileInput" accept=".xlsx">
              <label for="splitFileInput" class="file-input-label">
                ğŸ“Š Excel íŒŒì¼ ì„ íƒ
              </label>
            </div>
            <p style="color: #6c757d; margin-top: 10px;">Excel íŒŒì¼(.xlsx)ë§Œ ì§€ì›ë©ë‹ˆë‹¤</p>
          </div>

          <div id="splitFileInfo" class="file-info"></div>
          <div id="splitCleaningInfo" class="file-info cleaning-info">
            ğŸ§¹ HTML íƒœê·¸ ì •ë¦¬ ì™„ë£Œ! íƒœê·¸ë“¤ì´ ì ì ˆíˆ ë³€í™˜/ì œê±°ë˜ì—ˆìŠµë‹ˆë‹¤.
          </div>

          <div class="action-buttons">
            <button class="action-btn download-btn" onclick="executeSplit()">ğŸ” ë¶„ë¦¬ ì‹¤í–‰</button>
            <button class="action-btn example-btn" onclick="downloadSplitResult()">â¬‡ ë¶„ë¦¬ ê²°ê³¼ ë‹¤ìš´ë¡œë“œ</button>
          </div>

          <div id="splitResult">
            <div class="empty-state">
              <div class="icon">ğŸ”</div>
              <p>Excel íŒŒì¼ì„ ì—…ë¡œë“œí•˜ê³  ë¶„ë¦¬ë¥¼ ì‹¤í–‰í•´ì£¼ì„¸ìš”</p>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- ìŠ¤ë§ˆíŠ¸ ë§¤í•‘ íƒ­ -->
    <div id="smart" class="tab-content">
      <div class="smart-container">
        <!-- í—¤ë” ìœ ì§€ -->
        <div class="smart-header">
          <h2>ğŸ§  AI ê¸°ë°˜ ìŠ¤ë§ˆíŠ¸ í…ŒìŠ¤íŠ¸ ë§¤í•‘</h2>
          <p>Gemini AIê°€ ì¸ê°„ì²˜ëŸ¼ ìƒê°í•˜ì—¬ í…ŒìŠ¤íŠ¸ì¼€ì´ìŠ¤ë¥¼ ë¶„ì„í•˜ê³  ìµœì ì˜ Katalon ìŠ¤í¬ë¦½íŠ¸ë¥¼ ìƒì„±í•©ë‹ˆë‹¤</p>
        </div>

        <!-- 8ë‹¨ê³„ ì§„í–‰ë°”ë¡œ ìˆ˜ì • -->
        <div id="smartProgress" class="smart-progress-container" style="display: none;">
          <div class="progress-steps">
            <div class="step" id="step1">1. Summary ì´í•´</div>
            <div class="step" id="step2">2. TC ì¡°ê±´ íŒŒì•…</div>
            <div class="step" id="step3">3. í™˜ê²½ êµ¬ì„± ê²€ì¦</div>
            <div class="step" id="step4">4. ìŠ¤í… ë™ì‘ ë§¤í•‘</div>
            <div class="step" id="step5">5. ì„¤ê³„ë„ ì‘ì„±</div>
            <div class="step" id="step6">6. ì½”ë“œ ìƒì„±</div>
            <div class="step" id="step7">7. ì¡°ê±´ ì¶©ëŒ ê²€ì¦</div>
            <div class="step" id="step8">8. ê²°ê³¼ ìˆ˜ë ´ ê²€ì¦</div>
          </div>
          <div class="progress-details" id="progressDetails"></div>
        </div>

        <!-- ì¢Œìš° 2ë‹¨ ë ˆì´ì•„ì›ƒ -->
        <div class="smart-main-content">
          <!-- ì¢Œì¸¡: TC ì…ë ¥ + í’ˆì§ˆ í‰ê°€ (ì„¸ë¡œ 2ë¶„í• ) -->
          <div class="smart-input-section">

            <!-- ìƒë‹¨: TC ì…ë ¥ ì˜ì—­ (ê¸°ì¡´ ë†’ì´ì˜ 50%) -->
            <div class="smart-input-top">
              <div class="input-header">
                <h3>ğŸ“ í…ŒìŠ¤íŠ¸ì¼€ì´ìŠ¤ ì…ë ¥</h3>
                <div class="header-controls"></div>
                <button id="smartResetBtn" class="smart-reset-btn">ğŸ”„ ì´ˆê¸°í™”</button>
                <select id="aiModelSelect" class="ai-model-dropdown">
                  <option value="gemma-3-27b-it">Gemma-3-27b-it</option>
                  <option value="gemini-2.0-flash">Gemini-2.0-flash</option>
                </select>
              </div>
              <textarea id="smartTestcaseInput" class="smart-input-box" placeholder="..."></textarea>
              <button class="smart-generate-btn" onclick="startSmartMapping()">ğŸ§  ìŠ¤ë§ˆíŠ¸ ë¶„ì„ ì‹œì‘</button>
            </div>

            <!-- í•˜ë‹¨: ìŠ¤í¬ë¦½íŠ¸ í’ˆì§ˆ í‰ê°€ ì˜ì—­ (ìƒˆë¡œ ì¶”ê°€) -->
            <div class="smart-quality-section">
              <h3>ğŸ“Š ìŠ¤í¬ë¦½íŠ¸ í’ˆì§ˆ í‰ê°€</h3>
              <div class="quality-content">
                <div id="smartScriptScore" class="script-score-display" style="display: none;">
                  <div id="scoreCircleLarge" class="score-circle-large score-waiting">
                    <span id="scoreValueLarge">?</span>
                  </div>
                  <div id="scoreDetailsLarge" class="score-details-large">ë¶„ì„ì„ ì‹œì‘í•˜ë©´ AIê°€ ìƒì„±ëœ ìŠ¤í¬ë¦½íŠ¸ì˜ í’ˆì§ˆì„ í‰ê°€í•©ë‹ˆë‹¤</div>
                </div>
                <div id="qualityPlaceholder" class="quality-placeholder">
                  ìŠ¤í¬ë¦½íŠ¸ê°€ ìƒì„±ë˜ë©´ AI í’ˆì§ˆ í‰ê°€ê°€ ì—¬ê¸°ì— í‘œì‹œë©ë‹ˆë‹¤
                </div>
              </div>
            </div>

          </div>

          <!-- ìš°ì¸¡: ê²°ê³¼ ì˜ì—­ (ê¸°ì¡´ ìœ ì§€) -->
          <div id="smartResult" class="smart-result-container" style="display: none;">
            <h3>ğŸ¯ ìƒì„±ëœ Katalon ìŠ¤í¬ë¦½íŠ¸</h3>

            <div class="script-actions">
              <button onclick="copySmartScript()">ğŸ“‹ ë³µì‚¬</button>
              <button onclick="downloadSmartScript()">â¬‡ï¸ ë‹¤ìš´ë¡œë“œ</button>
              <button class="improve-script-btn" onclick="improveSmartScript()">ğŸ› ï¸ AI ê²€í†  ë°˜ì˜</button>
            </div>
            <pre id="smartGeneratedScript"></pre>
          </div>
        </div>
      </div>
    </div>

    <!-- Object Spy íƒ­ -->
    <div id="object-spy" class="tab-content">
        <div class="spy-container">
            <!-- ì¢Œì¸¡ íŒ¨ë„: ê¸°ë³¸ ì •ë³´ + Selector ì •ë³´ -->
            <div class="spy-left-panel">
                <div class="panel-header">ê¸°ë³¸ ì •ë³´ & Selector</div>
                
                <!-- ê¸°ë³¸ ì •ë³´ -->
                <div class="input-section">
                    <div class="section-title">ê¸°ë³¸ ì •ë³´</div>
                    
                    <div class="input-group">
                        <label class="input-label">Object Name <span class="required">*</span></label>
                        <div class="help-text">
                            ì¹´íƒˆë¡ ì—ì„œ ì‚¬ìš©í•  ì˜¤ë¸Œì íŠ¸ ì´ë¦„ (ì˜ë¬¸, ìˆ«ì, ì–¸ë”ìŠ¤ì½”ì–´ë§Œ)
                        </div>
                        <input type="text" class="input-field" id="objectName" placeholder="btn_login">
                    </div>

                    <div class="input-group">
                        <label class="input-label">Selection Method <span class="required">*</span></label>
                        <div class="help-text">
                            ì¹´íƒˆë¡ ì´ ì—˜ë¦¬ë¨¼íŠ¸ë¥¼ ì°¾ì„ ë•Œ ìš°ì„  ì‚¬ìš©í•  ë°©ë²•
                        </div>
                        <div class="radio-group">
                            <div class="radio-option">
                                <input type="radio" id="xpathRadio" name="selectorMethod" value="XPATH" checked>
                                <label for="xpathRadio">XPath</label>
                            </div>
                            <div class="radio-option">
                                <input type="radio" id="cssRadio" name="selectorMethod" value="CSS">
                                <label for="cssRadio">CSS</label>
                            </div>
                            <div class="radio-option">
                                <input type="radio" id="basicRadio" name="selectorMethod" value="BASIC">
                                <label for="basicRadio">BASIC</label>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Selector ì •ë³´ -->
                <div class="input-section">
                    <div class="section-title">Selector ì •ë³´</div>
                    
                    <div class="input-group">
                        <label class="input-label">XPath <span class="required">*</span></label>
                        <div class="help-text">
                            ê°œë°œìë„êµ¬(F12) â†’ Elements â†’ ìš°í´ë¦­ â†’ Copy â†’ Copy full XPath
                        </div>
                        <input type="text" class="input-field" id="xpathInput" placeholder="//button[@id='login']">
                        <div class="example-box">
                            ì˜ˆì‹œ: //html/body/main/div/div[2]/form/div/div[2]/button
                        </div>
                    </div>

                    <div class="input-group">
                        <label class="input-label">CSS Selector</label>
                        <div class="help-text">
                            ê°œë°œìë„êµ¬(F12) â†’ Elements â†’ ìš°í´ë¦­ â†’ Copy â†’ Copy selector
                        </div>
                        <input type="text" class="input-field" id="cssSelector" placeholder="#login">
                        <div class="example-box">
                            ì˜ˆì‹œ: button.MuiButton-root.MuiButton-text
                        </div>
                    </div>

                    <div class="input-group">
                        <label class="input-label">BASIC Selector</label>
                        <div class="help-text">
                            ì¹´ìŠ¤í…€ ê¸°ë³¸ selector (ë³µí•© ì¡°ê±´ ë“±)
                        </div>
                        <input type="text" class="input-field" id="basicSelector" placeholder="//button[contains(@class, 'login')]">
                    </div>
                </div>

                <!-- XPath ë³€í˜•ë“¤ -->
                <div class="input-section">
                    <div class="section-title">XPath ë³€í˜•ë“¤</div>
                    
                    <div class="input-group">
                        <label class="input-label">XPath Attributes</label>
                        <div class="help-text">
                            ì†ì„± ê¸°ë°˜ XPath (type, id, class ë“±)
                        </div>
                        <input type="text" class="input-field" id="xpathAttributes" placeholder="//button[@type='submit']">
                    </div>

                    <div class="input-group">
                        <label class="input-label">XPath Position</label>
                        <div class="help-text">
                            ìœ„ì¹˜ ê¸°ë°˜ XPath (ìƒëŒ€ì  ìœ„ì¹˜)
                        </div>
                        <input type="text" class="input-field" id="xpathPosition" placeholder="//div[2]/button">
                    </div>

                    <div class="input-group">
                        <label class="input-label">XPath Neighbor</label>
                        <div class="help-text">
                            ì£¼ë³€ ì—˜ë¦¬ë¨¼íŠ¸ ê¸°ë°˜ XPath
                        </div>
                        <input type="text" class="input-field" id="xpathNeighbor" placeholder="(.//*[text()='Username'])[1]/following::input[1]">
                    </div>

                    <div class="input-group">
                        <label class="input-label">XPath Custom</label>
                        <div class="help-text">
                            ë³µí•© ì¡°ê±´ XPath (text, class ì¡°í•©)
                        </div>
                        <input type="text" class="input-field" id="xpathCustom" placeholder="//button[text()='ë¡œê·¸ì¸' and @class='btn-primary']">
                    </div>
                </div>
            </div>

            <!-- ìš°ì¸¡ íŒ¨ë„: ì—˜ë¦¬ë¨¼íŠ¸ ì†ì„± + Smart Locator -->
            <div class="spy-right-panel">
                <div class="panel-header">ì—˜ë¦¬ë¨¼íŠ¸ ì†ì„± & Locator</div>
                
                <!-- ì—˜ë¦¬ë¨¼íŠ¸ ì†ì„±ë“¤ -->
                <div class="input-section">
                    <div class="section-title">ì—˜ë¦¬ë¨¼íŠ¸ ì†ì„±ë“¤</div>
                    
                    <div class="input-group">
                        <label class="input-label">Tag Name</label>
                        <div class="help-text">
                            HTML íƒœê·¸ ì´ë¦„ (button, input, div, a, span)
                        </div>
                        <input type="text" class="input-field" id="tagName" placeholder="button">
                    </div>

                    <div class="input-group">
                        <label class="input-label">Class</label>
                        <div class="help-text">
                            ì—˜ë¦¬ë¨¼íŠ¸ì˜ class ì†ì„± ì „ì²´ ê°’ (ê°œë°œìë„êµ¬ì—ì„œ ë³µì‚¬)
                        </div>
                        <input type="text" class="input-field" id="className" placeholder="MuiButton-root MuiButton-contained">
                    </div>

                    <div class="input-group">
                        <label class="input-label">ID</label>
                        <div class="help-text">
                            ì—˜ë¦¬ë¨¼íŠ¸ì˜ id ì†ì„± ê°’
                        </div>
                        <input type="text" class="input-field" id="idValue" placeholder="login-button">
                    </div>

                    <div class="input-group">
                        <label class="input-label">Type</label>
                        <div class="help-text">
                            input/buttonì˜ type ì†ì„± (text, password, submit, button)
                        </div>
                        <input type="text" class="input-field" id="typeValue" placeholder="submit">
                    </div>

                    <div class="input-group">
                        <label class="input-label">Name</label>
                        <div class="help-text">
                            í¼ ì—˜ë¦¬ë¨¼íŠ¸ì˜ name ì†ì„±
                        </div>
                        <input type="text" class="input-field" id="nameValue" placeholder="username">
                    </div>

                    <div class="input-group">
                        <label class="input-label">Text</label>
                        <div class="help-text">
                            ì—˜ë¦¬ë¨¼íŠ¸ê°€ í¬í•¨í•˜ëŠ” í…ìŠ¤íŠ¸ (ë²„íŠ¼ í…ìŠ¤íŠ¸, ë§í¬ í…ìŠ¤íŠ¸ ë“±)
                        </div>
                        <input type="text" class="input-field" id="textValue" placeholder="ë¡œê·¸ì¸">
                    </div>
                </div>

                <!-- Smart Locator -->
                <div class="input-section">
                    <div class="section-title">Smart Locator</div>
                    
                    <div class="input-group">
                        <label class="input-label">Smart Locator</label>
                        <div class="help-text">
                            ì¹´íƒˆë¡ ì˜ ì§€ëŠ¥í˜• locator (í…ìŠ¤íŠ¸ë‚˜ ì—­í•  ê¸°ë°˜)
                        </div>
                        <input type="text" class="input-field" id="smartLocator" placeholder='internal:role=button[name="ë¡œê·¸ì¸"i]'>
                        <div class="example-box">
                            ì˜ˆì‹œ: internal:text="íšŒì›ê°€ì…"s, internal:role=button[name="ë¡œê·¸ì¸"i]
                        </div>
                    </div>
                </div>

                <!-- ê¸°íƒ€ ì†ì„±ë“¤ -->
                <div class="input-section">
                    <div class="section-title">ê¸°íƒ€ ì†ì„±ë“¤</div>
                    
                    <div class="input-group">
                        <label class="input-label">ì¶”ê°€ ì†ì„± (JSON)</label>
                        <div class="help-text">
                            ì¶”ê°€ ì†ì„±ë“¤ì„ JSON í˜•íƒœë¡œ ì…ë ¥
                        </div>
                        <textarea class="input-field textarea-field" id="otherAttributes" placeholder='{"placeholder": "ì•„ì´ë””ë¥¼ ì…ë ¥í•˜ì„¸ìš”", "maxlength": "50"}'></textarea>
                    </div>
                </div>

                <div class="action-buttons">
                    <button class="btn btn-primary" onclick="generateObjectFile()">Object Repository íŒŒì¼ ìƒì„±</button>
                    <button class="btn btn-secondary" onclick="clearAll()">ì „ì²´ ì´ˆê¸°í™”</button>
                </div>
            </div>
        </div>
    </div>

  </main>

  <!-- ìˆ˜íŒŒë² ì´ìŠ¤ ì„¤ì • -->
  <script>
    const { createClient } = supabase;
    const testClient = createClient(
      'https://sposmjzjicgpxmpbzomn.supabase.co',
      'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InNwb3NtanpqaWNncHhtcGJ6b21uIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTA3OTYxNzIsImV4cCI6MjA2NjM3MjE3Mn0.UjTxOh7tVc6F_kw_5rCOlntnWfrljzhp0ntmeKLuW3c'
    );

    window.getSupabaseClient = () => testClient;
    window.isSupabaseConnected = () => true;
    window.findMappingInSupabase = async function (keyword) {
      const { data, error } = await testClient
        .from('katalon_mapping_complete')
        .select('*')
        .contains('keywords', [keyword.toLowerCase()]);

      if (error || !data || data.length === 0) {
        return { found: false, keyword: keyword };
      }

      return {
        found: true,
        mapping: data[0],
        source: 'complete',
        action: data[0].action
      };
    };

    console.log('ìˆ˜íŒŒë² ì´ìŠ¤ í•¨ìˆ˜ ë“±ë¡ ì™„ë£Œ');
  </script>

<!-- ê¸°ì¡´ ë¼ì´ë¸ŒëŸ¬ë¦¬ë“¤ -->
<script src="libs/common_utils_zip.js"></script>
<script src="libs/csv_parser_zip.js"></script>
<script src="libs/groovy_converter_zip.js"></script>
<script src="libs/report_viewer_zip.js"></script>
<script src="libs/script.js"></script>
<script src="libs/gemini-keywords.js"></script>

<!-- í…ŒìŠ¤íŠ¸ì¼€ì´ìŠ¤ ë§¤í•‘ ëª¨ë“ˆë“¤ -->
<script src="libs/testcase_mapping/testcase_parser.js"></script>
<script src="libs/testcase_mapping/katalon_mapper.js"></script>
<script src="libs/testcase_mapping/testcase_ui_controller.js"></script>
<script src="libs/testcase_mapping/testcase_mapper_supabase.js"></script>

<!-- í†µí•© í”„ë¡¬í”„íŠ¸ íŒŒì¼ -->
<script src="libs/prompts/gemma_master_prompt.js"></script>

<!-- AI ì—”ì§„ë“¤ -->
<script src="libs/ai_engine_Gemma-3-27b-it.js"></script>
<script src="libs/ai_engine_gemini-2.0-flash.js"></script>

  <!-- ì• í”Œë¦¬ì¼€ì´ì…˜ ë©”ì¸ ìŠ¤í¬ë¦½íŠ¸ë“¤ -->
  <script src="assets/js/ui-utils.js"></script>
  <script src="assets/js/file-handlers.js"></script>
  <script src="assets/js/main.js"></script>

  <script>
    // íƒ­ ì „í™˜ ê¸°ëŠ¥
    document.querySelectorAll('.tab-button').forEach(button => {
      button.addEventListener('click', () => {
        if (button.disabled) {
          return;
        }

        const tabId = button.getAttribute('data-tab');
        const targetTab = document.getElementById(tabId);

        if (targetTab) {
          document.querySelectorAll('.tab-button').forEach(btn => btn.classList.remove('active'));
          document.querySelectorAll('.tab-content').forEach(content => content.classList.remove('active'));

          button.classList.add('active');
          targetTab.classList.add('active');
        } else {
          console.warn(`íƒ­ì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤: ${tabId}`);
        }
      });
    });

    // íŒŒì¼ ì„ íƒ ì‹œ ë ˆì´ë¸” ì—…ë°ì´íŠ¸
    document.getElementById('csvFile').addEventListener('change', function () {
      const label = this.nextElementSibling;
      if (this.files.length > 0) {
        label.innerHTML = `${this.files[0].name}`;
        label.style.background = 'linear-gradient(135deg, #10b981 0%, #059669 100%)';
      }
    });

    document.getElementById('excelFile').addEventListener('change', function () {
      const label = this.nextElementSibling;
      if (this.files.length > 0) {
        label.innerHTML = `${this.files[0].name}`;
        label.style.background = 'linear-gradient(135deg, #10b981 0%, #059669 100%)';
      }
    });

    document.getElementById('reportFileInput').addEventListener('change', function () {
      const label = this.nextElementSibling;
      if (this.files.length > 0) {
        label.innerHTML = `${this.files[0].name}`;
        label.style.background = 'linear-gradient(135deg, #10b981 0%, #059669 100%)';
      }
    });

    // TC Merger ë‚´ë¶€ íƒ­ ì „í™˜
    function switchTCMergerTab(tab) {
      document.querySelectorAll('.tcmerger-tab-btn').forEach(btn => btn.classList.remove('active'));
      document.querySelectorAll('.tcmerger-tab-content').forEach(content => content.classList.remove('active'));

      const targetBtn = document.querySelector(`[data-tcmerger-tab="${tab}"]`);
      if (targetBtn) {
        targetBtn.classList.add('active');
      }

      const targetTab = document.getElementById(tab + 'Tab');
      if (targetTab) {
        targetTab.classList.add('active');
      }
    }

    // ì—ëŸ¬/ì„±ê³µ ë©”ì‹œì§€ í•¨ìˆ˜ë“¤
    function showError(message) {
      const errorDiv = document.getElementById('error');
      errorDiv.innerHTML = `
        <div style="display: flex; align-items: center;">
          <span style="margin-right: 10px;">âš ï¸</span>
          <span>${message}</span>
        </div>
      `;
      errorDiv.style.display = 'block';

      setTimeout(() => {
        errorDiv.style.display = 'none';
      }, 3000);
    }

    function showSuccess(message) {
      const errorDiv = document.getElementById('error');
      errorDiv.innerHTML = `
        <div style="display: flex; align-items: center; background: linear-gradient(135deg, #ecfdf5 0%, #d1fae5 100%); color: #065f46; border-left-color: #10b981;">
          <span style="margin-right: 10px;">âœ…</span>
          <span>${message}</span>
        </div>
      `;
      errorDiv.style.display = 'block';

      setTimeout(() => {
        errorDiv.style.display = 'none';
      }, 3000);
    }

    function showLoading(buttonElement, originalText) {
      buttonElement.innerHTML = `<span class="loading"></span>${originalText}`;
      buttonElement.disabled = true;
    }

    function hideLoading(buttonElement, originalText) {
      buttonElement.innerHTML = originalText;
      buttonElement.disabled = false;
    }

    // ìŠ¤ë§ˆíŠ¸ ë§¤í•‘ í•¨ìˆ˜ë“¤
    async function startSmartMapping() {
      const selectedModel = document.getElementById('aiModelSelect').value;

      if (selectedModel === 'gemma-3-27b-it') {
        if (typeof GemmaEngine === 'undefined') {
          alert('AI ì—”ì§„ì´ ë¡œë“œë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤. í˜ì´ì§€ë¥¼ ìƒˆë¡œê³ ì¹¨í•´ì£¼ì„¸ìš”.');
          return;
        }

        if (!window.gemmaEngine) {
          console.log('Gemma ì—”ì§„ ìƒì„± ì¤‘...');
          window.gemmaEngine = new GemmaEngine();
        }
        await startSmartMappingGemma();

      } else if (selectedModel === 'gemini-2.0-flash') {
        if (typeof GeminiFlashEngine === 'undefined') {
          alert('AI ì—”ì§„ì´ ë¡œë“œë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤. í˜ì´ì§€ë¥¼ ìƒˆë¡œê³ ì¹¨í•´ì£¼ì„¸ìš”.');
          return;
        }

        if (!window.geminiFlashEngine) {
          console.log('Gemini Flash ì—”ì§„ ìƒì„± ì¤‘...');
          window.geminiFlashEngine = new GeminiFlashEngine();
        }
        await startSmartMappingGemini();
      }
    }

    function improveSmartScript() {
      const selectedModel = document.getElementById('aiModelSelect').value;

      if (selectedModel === 'gemma-3-27b-it') {
        if (window.gemmaEngine) {
          window.gemmaEngine.improveAndReEvaluateScript();
        } else {
          alert('Gemma AI ì—”ì§„ì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.');
        }
      } else if (selectedModel === 'gemini-2.0-flash') {
        if (window.geminiFlashEngine) {
          window.geminiFlashEngine.improveAndReEvaluateScript();
        } else {
          alert('Gemini Flash AI ì—”ì§„ì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.');
        }
      } else {
        alert('ì§€ì›ë˜ì§€ ì•ŠëŠ” AI ëª¨ë¸ì…ë‹ˆë‹¤.');
      }
    }

    function resetSmartMapping() {
      console.log('ìŠ¤ë§ˆíŠ¸ ë§¤í•‘ ì „ì²´ ì´ˆê¸°í™” ì‹œì‘');

      if (!confirm('ìŠ¤ë§ˆíŠ¸ ë§¤í•‘ì„ ì´ˆê¸°í™”í•˜ì‹œê² ìŠµë‹ˆê¹Œ?\nëª¨ë“  ì…ë ¥ ë‚´ìš©ê³¼ ê²°ê³¼ê°€ ì‚­ì œë©ë‹ˆë‹¤.')) {
        return;
      }

      try {
        const testcaseInput = document.getElementById('smartTestcaseInput');
        if (testcaseInput) {
          testcaseInput.value = '';
        }

        const modelSelect = document.getElementById('aiModelSelect');
        if (modelSelect) {
          modelSelect.value = 'gemma-3-27b-it';
        }

        const progressContainer = document.getElementById('smartProgress');
        if (progressContainer) {
          progressContainer.style.display = 'none';
        }

        for (let i = 1; i <= 8; i++) {
          const step = document.getElementById(`step${i}`);
          if (step) {
            step.className = 'step';
          }
        }

        const progressDetails = document.getElementById('progressDetails');
        if (progressDetails) {
          progressDetails.innerHTML = '';
        }

        const resultContainer = document.getElementById('smartResult');
        if (resultContainer) {
          resultContainer.style.display = 'none';
        }

        const scriptElement = document.getElementById('smartGeneratedScript');
        if (scriptElement) {
          scriptElement.textContent = '';
        }

        const scoreDisplay = document.getElementById('smartScriptScore');
        const placeholder = document.getElementById('qualityPlaceholder');

        if (scoreDisplay && placeholder) {
          scoreDisplay.style.display = 'none';
          placeholder.style.display = 'block';
        }

        const generateBtn = document.querySelector('.smart-generate-btn');
        if (generateBtn) {
          generateBtn.disabled = false;
          generateBtn.innerHTML = 'ğŸ§  ìŠ¤ë§ˆíŠ¸ ë¶„ì„ ì‹œì‘';
        }

        window.smartGeneratedScript = null;
        if (window.gemmaEngine) {
          window.gemmaEngine.lastEvaluation = null;
        }
        if (window.geminiFlashEngine) {
          window.geminiFlashEngine.lastEvaluation = null;
        }

        console.log('ìŠ¤ë§ˆíŠ¸ ë§¤í•‘ ì´ˆê¸°í™” ì™„ë£Œ');

        const resetBtn = document.getElementById('smartResetBtn');
        if (resetBtn) {
          const originalText = resetBtn.innerHTML;
          resetBtn.innerHTML = 'ì´ˆê¸°í™”ë¨';
          resetBtn.disabled = true;

          setTimeout(() => {
            resetBtn.innerHTML = originalText;
            resetBtn.disabled = false;
          }, 1500);
        }

      } catch (error) {
        console.error('ì´ˆê¸°í™” ì‹¤íŒ¨:', error);
        alert('ì´ˆê¸°í™” ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤: ' + error.message);
      }
    }

    document.addEventListener('DOMContentLoaded', function () {
      const resetBtn = document.getElementById('smartResetBtn');
      if (resetBtn) {
        resetBtn.addEventListener('click', resetSmartMapping);
        console.log('ìŠ¤ë§ˆíŠ¸ ë§¤í•‘ ì´ˆê¸°í™” ë²„íŠ¼ ì´ë²¤íŠ¸ ë“±ë¡ ì™„ë£Œ');
      }
    });

    window.resetSmartMapping = resetSmartMapping;
  </script>
</body>

</html>